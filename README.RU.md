[(EN)](README.md) **(RU)**

# Конвертер из растровых картинок в 3D-сетку треугольников

Программа на Python для трассировки карты высот в графическом формате ([PNG](http://www.libpng.org/pub/png/)) в трёхмерную векторную сетку треугольников (triangle meash) в формате [POVRay](https://www.povray.org/). Координаты x, y пикселя соответствуют координатам x, y узлов сетки, яркость пикселя соответствует высоте (z) узла сетки. В случае исходных графических файлов с низким разрешением полученная при трассировке 3D-сетка обеспечивает лучшее визуальное качество рендеренга, нежели исходные графические файлы при их использовании в качестве heightfield напрямую.

*Версии*

- **img2mesh.01.xxx** - конвертирует квадрат 2x2 пикселя в 2 треугольника с общей гипотенузой. Версия 01.003 - выбор диагонали квадрата для гипотенуз ("перегиба" квадрата) в соответствии с локальным градиентом. **Разработка прекращена на версии 01.004 в пользу версии 02**, обеспечивающей улучшенный рендеринг.

- **img2mesh.02.xxx** - конвертирует 1 пиксель в пирамиду из 4 треугольников. Узлы сетки автоматически связываются, что обеспечивает возможность использования сетки в [CSG](https://www.povray.org/documentation/3.7.0/r3_4.html#r3_4_5_4)-операциях (начиная с версии 02.002 к сцене добавлена операция intersection с кубом, что придаёт сетке боковые поверхности и дно. Редактируя размеры куба (или заменяя его на цилиндр и т.п.), можно аккуратно обрезать бока сетки, а также менять "уровень воды", прорезая отверстия на месте минимумов).

- **img2mesh.02.005** - существенное внутреннее изменение. Модуль чтения исходных PNG изменен с Pillow на [PyPNG](https://gitlab.com/drj11/pypng), что уменьшает объем внешних зависимостей программы, а главное - обеспечивает трассировку исходных PNG с цветовой глубиной 16 бит на канал, что резко увеличивает разрешение сигнала по оси z.

*Зависимости от внешних библиотек:* Tkinter, PyPNG / Pillow

*Инструкция по эксплуатации:* программы оборудованы минималистическим GUI, в результате всё, что вы должны сделать после запуска программы, это с помощью окна "Open..." выбрать и открыть файл PNG, с помощью окна "Save..." выбрать POV-файл для сохранения, подождать, пока программа отработает и закроется, затем открыть полученный POV-файл в POVRay и нажать кнопочку "Render". Экспортированная сцена содержит необходимый минимум глобальных переменных и объектов (камера, свет) для ознакомительного рендеринга без редактирования. Текстуры объекта и параметры камеры и т.п. записаны в максимально общем виде с комментариями, и должны быть просты для понимания и редактирования.

Во избежание санкций проект зеркалится:

[github Dnyarri](https://github.com/Dnyarri/img2mesh)

[gitflic Dnyarri](https://gitflic.ru/project/dnyarri/img2mesh)
